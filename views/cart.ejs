<%- include('parts/header') %>
    <%- include('parts/navbar') %>
        <div class="container">
            <% if(items.length === 0) { %>
                <p class="alert alert-danger">There is no items</p>
                <% } else { %>
                    <div class="card mb-3" style="max-width: 540px;background-color:#F0F0F0;">
                        <form action="/orders" method="POST" class="add-to-cart-form">

                            <% for (let i = 0; i < items.length; i++) { %>
                                <input type="hidden" name="test<%=i%>" value=<%=items[i].amount%>>
                                <input type="hidden" name="test<%=i%>5" value=<%=items[i].name%>>
                                <input type="hidden" name="test<%=i%>15" value=<%=items[i].price%>>
                                <input type="hidden" name="test<%=i%>10" value="<%=items[i].productId%>">
                                <input type="hidden" name="test<%=i%>20" value=<%=items[i].descrption%>>
                                <%}%>
                                    <input type="hidden" name="id" value=<%=items[0].userId%>>
                                    <input type="submit" value="Place your order" style="background-color:#FFDE71;width:100%;border-radius: 8px;">

                        </form>
                    </div>

                    <% for (let i = 0; i < items.length; i++) { %>
                        <%total=Number(total)+items[i].price*items[i].amount%>

                            <div class="card mb-3" style="max-width: 540px;background-color:#F2FCFF;">
                                <div class="row no-gutters">
                                    <div class="col-md-4">
                                        <img src="/<%= items[i].image %>" style="width: 95%;height:95%; " alt="<%=items[i].name %>">
                                    </div>
                                    <div class="col-md-8">
                                        <div class="card-body">
                                            <h5 class="card-title">
                                                <%= items[i].name %>
                                            </h5>
                                            <h5 class="card-title">Details</h5>
                                            <p class="card-text">
                                                <%=items[i].description%>
                                            </p>

                                            <p class="card-text">
                                                Price:
                                                <%=items[i].price%>$
                                            </p>


                                        </div>

                                    </div>

                                    <div class=" container row">

                                        <div class="col-9">
                                            <br>
                                            <form method="POST">
                                                <input type="hidden" name="cartId" value="<%= items[i]._id%>">
                                                <button onclick="myFunction1('<%= items[i]._id%>')" style="border-radius: 6px;
        <div id="demo" class="carousel slide container" data-ride="carousel">

            <!-- Indicators -->
            <ul class="carousel-indicators">
                <li data-target="#demo" data-slide-to="0" class="active"></li>
                <li data-target="#demo" data-slide-to="1"></li>
                <li data-target="#demo" data-slide-to="2"></li>
            </ul>

            <!-- The slideshow -->
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="/1.jpg" style="height: 200px;" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="/2.jpg" style="height: 200px;" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="/3.jpg" style="height: 200px;" alt="...">
                </div>
            </div>

            <!-- Left and right controls -->
            <a class="carousel-control-prev" href="#demo" data-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </a>
            <a class="carousel-control-next" href="#demo" data-slide="next">
                <span class="carousel-control-next-icon"></span>
            </a>
        </div>

        <div class="container">

            <form class="filter" action="/" method="GET">
                <div class="row">
                    <div class="col col-md-10">
                        <select name="category" class="form-control">
                    <option value="all">All</option>
                    <option value="clothes">Clothes</option>
                    <option value="phones">Phones</option>
                    <option value="computers">Computers</option>
                </select>
                    </div>
                    <div class="col col-md-2">
                        <input type="submit" class="btn btn-primary" value="Filter">
                    </div>
                </div>
            </form>

            <% if(validationError) { %>
                <p class="alert alert-danger">
                    <%= validationError.msg%>
                </p>
                <% } %>

                    <% if(products.length === 0) { %>
                        <div class="alert alert-danger">
                            there is no products
                        </div>
                        <% } else { %>
                            <div class="row">
                                <% for(let product of products) { %>
                                    <div class="col col-12 col-md-6 col-lg-4 col-xl-3">
                                        <div class="card" style="width: 100%;background-color:#F0F0F0">
                                            <div class="card-header">

                                                <div id="<%=product._id%>+demo" class="carousel slide container" data-ride="carousel">
                                                    <!-- Indicators -->
                                                    <ul class="carousel-indicators">
                                                        <%var i=0 %>
                                                            <%for (image of product.image){ %>
                                                                <% if (i===0){%>
                                                                    <li data-target="#<%=product._id%>+demo" data-slide-to="<%=i%>" class="active"></li>
                                                                    <%}else{%>
                                                                        <li data-target="#<%=product._id%>+demo" data-slide-to="<%=i%>"></li>
                                                                        <%}%>
                                                                            <%i++%>
                                                                                <%}%>
                                                    </ul>
                                                    <!-- The slideshow -->
                                                    <div class="carousel-inner">
                                                        <% i=0 %>
                                                            <%for (image of product.image){ %>
                                                                <% if (i===0){%>
                                                                    <div class="carousel-item active">
                                                                        <img src="/<%= product.image[i].filename%>" class="card-img-top" style="height: 200px;text-align: center;" alt="<%= product.image[i].originalname%>">
                                                                    </div>
                                                                    <%}else{%>
                                                                        <div class="carousel-item">
                                                                            <img src="/<%= product.image[i].filename%>" class="card-img-top" style="height: 200px;text-align: center;" alt="<%= product.image[i].originalname%>">
                                                                        </div>
                                                                        <%}%>
                                                                            <%i++%>

                                                                                <%}%>
                                                    </div>

                                                    <!-- Left and right controls -->
                                                    <a class="carousel-control-prev" href="#<%=product._id%>+demo" data-slide="prev">
                                                        <span class="carousel-control-prev-icon"></span>
                                                    </a>
                                                    <a class="carousel-control-next" href="#<%=product._id%>+demo" data-slide="next">
                                                        <span class="carousel-control-next-icon"></span>
                                                    </a>
                                                </div>
                                            </div>





                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-4">
                                                        <h5 class="card-title" style="font-size:15px;">
                                                            <a href="/product/<%= product._id%>">
                                                                <%= product.name%>
                                                            </a>
                                                            <p style="font-size:13px;">Price:
                                                                <%= product.price%> $</p>
                                                        </h5>
                                                    </div>
                                                    <div class="col-8">
                                                        <button class="btn-sm" onclick="myFunction1('<%= product._id%>')" style="border-radius: 6px;
        <div id="demo" class="carousel slide container" data-ride="carousel">

            <!-- Indicators -->
            <ul class="carousel-indicators">
                <li data-target="#demo" data-slide-to="0" class="active"></li>
                <li data-target="#demo" data-slide-to="1"></li>
                <li data-target="#demo" data-slide-to="2"></li>
            </ul>

            <!-- The slideshow -->
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="/1.jpg" style="height: 200px;" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="/2.jpg" style="height: 200px;" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="/3.jpg" style="height: 200px;" alt="...">
                </div>
            </div>

            <!-- Left and right controls -->
            <a class="carousel-control-prev" href="#demo" data-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </a>
            <a class="carousel-control-next" href="#demo" data-slide="next">
                <span class="carousel-control-next-icon"></span>
            </a>
        </div>

        <div class="container">

            <form class="filter" action="/" method="GET">
                <div class="row">
                    <div class="col col-md-10">
                        <select name="category" class="form-control">
                    <option value="all">All</option>
                    <option value="clothes">Clothes</option>
                    <option value="phones">Phones</option>
                    <option value="computers">Computers</option>
                </select>
                    </div>
                    <div class="col col-md-2">
                        <input type="submit" class="btn btn-primary" value="Filter">
                    </div>
                </div>
            </form>

            <% if(validationError) { %>
                <p class="alert alert-danger">
                    <%= validationError.msg%>
                </p>
                <% } %>

                    <% if(products.length === 0) { %>
                        <div class="alert alert-danger">
                            there is no products
                        </div>
                        <% } else { %>
                            <div class="row">
                                <% for(let product of products) { %>
                                    <div class="col col-12 col-md-6 col-lg-4 col-xl-3">
                                        <div class="card" style="width: 100%;background-color:#F0F0F0">
                                            <div class="card-header">

                                                <div id="<%=product._id%>+demo" class="carousel slide container" data-ride="carousel">
                                                    <!-- Indicators -->
                                                    <ul class="carousel-indicators">
                                                        <%var i=0 %>
                                                            <%for (image of product.image){ %>
                                                                <% if (i===0){%>
                                                                    <li data-target="#<%=product._id%>+demo" data-slide-to="<%=i%>" class="active"></li>
                                                                    <%}else{%>
                                                                        <li data-target="#<%=product._id%>+demo" data-slide-to="<%=i%>"></li>
                                                                        <%}%>
                                                                            <%i++%>
                                                                                <%}%>
                                                    </ul>
                                                    <!-- The slideshow -->
                                                    <div class="carousel-inner">
                                                        <% i=0 %>
                                                            <%for (image of product.image){ %>
                                                                <% if (i===0){%>
                                                                    <div class="carousel-item active">
                                                                        <img src="/<%= product.image[i].filename%>" class="card-img-top" style="height: 200px;text-align: center;" alt="<%= product.image[i].originalname%>">
                                                                    </div>
                                                                    <%}else{%>
                                                                        <div class="carousel-item">
                                                                            <img src="/<%= product.image[i].filename%>" class="card-img-top" style="height: 200px;text-align: center;" alt="<%= product.image[i].originalname%>">
                                                                        </div>
                                                                        <%}%>
                                                                            <%i++%>

                                                                                <%}%>
                                                    </div>

                                                    <!-- Left and right controls -->
                                                    <a class="carousel-control-prev" href="#<%=product._id%>+demo" data-slide="prev">
                                                        <span class="carousel-control-prev-icon"></span>
                                                    </a>
                                                    <a class="carousel-control-next" href="#<%=product._id%>+demo" data-slide="next">
                                                        <span class="carousel-control-next-icon"></span>
                                                    </a>
                                                </div>
                                            </div>





                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-4">
                                                        <h5 class="card-title" style="font-size:15px;">
                                                            <a href="/product/<%= product._id%>">
                                                                <%= product.name%>
                                                            </a>
                                                            <p style="font-size:13px;">Price:
                                                                <%= product.price%> $</p>
                                                        </h5>
                                                    </div>
                                                    <div class="col-8">
                                                        <button class="btn-sm" onclick="myFunction1('<%= product._id%>')" style="border-radius: 6px;text-align: center;width:10%">-</button>
                                                        <input id="<%= product._id%>" type="number" value=0 style="width:50%;">
                                                        <button class="btn-sm" onclick="myFunction('<%= product._id%>')" style="border-radius: 6px;text-align: center;width:10%">+</button>
                                                    </div>
                                                </div>
                                                <form action="/cart" method="POST" class="add-to-cart-form">
                                                    <input id="<%= product._id%>+1" type="hidden" name="amount" value=0 class="form-control">
                                                    <input type="hidden" name="name" value="<%= product.name%>">
                                                    <input type="hidden" name="price" value="<%= product.price%>">
                                                    <input type="hidden" name="productId" value="<%= product._id%>">
                                                    <input type="hidden" name="image" value="<%= product.image[0].filename%>">
                                                    <input type="hidden" name="redirectTo" value="/">
                                                    <input type="submit" value="Add to cart" style="background-color:#FFDE71;width:100%;border-radius: 8px;">
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <% } %>
                            </div>
                            <% } %>
        </div>
width:10%">-</button>
                                                        <input id="<%= product._id%>" type="number" value=0 style="width:50%;">
                                                        <button class="btn-sm" onclick="myFunction('<%= product._id%>')" style="border-radius: 6px;width:10%">+</button>
                                                    </div>
                                                </div>
                                                <form action="/cart" method="POST" class="add-to-cart-form">
                                                    <input id="<%= product._id%>+1" type="hidden" name="amount" value=0 class="form-control">
                                                    <input type="hidden" name="name" value="<%= product.name%>">
                                                    <input type="hidden" name="price" value="<%= product.price%>">
                                                    <input type="hidden" name="productId" value="<%= product._id%>">
                                                    <input type="hidden" name="image" value="<%= product.image[0].filename%>">
                                                    <input type="hidden" name="redirectTo" value="/">
                                                    <input type="submit" value="Add to cart" style="background-color:#FFDE71;width:100%;border-radius: 8px;">
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <% } %>
                            </div>
                            <% } %>
        </div>
width:10%" formaction="/cart/save">-</button>
                                                <input id="<%= items[i]._id%>" type="number" value="<%= items[i].amount %>" name="amount" style="width:20%;">
                                                <button onclick="myFunction('<%= items[i]._id%>')" style="border-radius: 6px;width:10%" formaction="/cart/save">+</button>
                                            </form>
                                        </div>
                                        <div class="col-3">

                                            <form method="POST">
                                                <br>
                                                <input type="hidden" name="cartId" value="<%= items[i]._id%>">
                                                <input type="submit" style="border-radius: 6px;width:100%;background-color:white;color:black;" value="Delete" formaction="/cart/delete">

                                            </form>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <% } %>

                                <% } %>

                                    <% if(items.length > 0) { %>
                                        <div class="card mb-3" style="max-width: 540px;background-color:#F0F0F0;">
                                            <div class="  row ">
                                                <div class="col-10">
                                                    <p>Items(
                                                        <%=items.length%>):
                                                </div>
                                                <div class="col-2">
                                                    <%=total%>$
                                                </div>

                                                <div class="col-10">
                                                    <p>Shipping:</p>
                                                </div>
                                                <div class="col-2">
                                                    <%=items.length*3%>$
                                                </div>

                                                <div class="col-10">
                                                    <p>Tax:</p>
                                                </div>
                                                <div class="col-2">
                                                    <%=Math.round(total*0.05)%>$
                                                </div>
                                                <div class="col-10">
                                                    <h5>Total:</h5>
                                                </div>
                                                <div class="col-2">
                                                    <%=total*0.05+total+ items.length*3%>$
                                                </div>

                                            </div>

                                        </div>
                                        <h4>Ship to:</h4>
                                        <div class="card mb-3" style="max-width: 540px;background-color:#F0F0F0;">
                                            <div class="  row ">
                                                <div class="col-10">
                                                    <p>
                                                        Name:
                                                        <%= addresses[0].fullname %>
                                                    </p>
                                                    <p>
                                                        Email:
                                                        <%= addresses[0].userId %>
                                                    </p>
                                                    <p>
                                                        Country:
                                                        <%= addresses[0].country %>
                                                    </p>
                                                    <p>
                                                        State:
                                                        <%= addresses[0].state %>
                                                    </p>
                                                    <p>
                                                        ZIP Code:
                                                        <%= addresses[0].zip %>
                                                    </p>
                                                    <p>
                                                        City:
                                                        <%= addresses[0].city %>
                                                    </p>
                                                    <p>
                                                        Adress:
                                                        <%= addresses[0].address1 %>
                                                    </p>
                                                    <p>
                                                        <%= addresses[0].address2 %>
                                                    </p>
                                                    <p>
                                                        Phone:
                                                        <%= addresses[0].phone %>
                                                    </p>
                                                </div>
                                                <div class="row">
                                                    <div class="col-10">

                                                    </div>
                                                    <div class="col-2"></div>
                                                    <form action="/shippingaddress" method="POST">
                                                        <input type="submit" value=">">
                                                        <input type="hidden" name="id" value="<%= addresses[0]._id %>">
                                                        <input type="hidden" name="fullname" value="<%= addresses[0].fullname %>">
                                                        <input type="hidden" name="country" value="<%= addresses[0].country %>">
                                                        <input type="hidden" name="address1" value="<%= addresses[0].address1 %>">
                                                        <input type="hidden" name="address2" value="<%= addresses[0].address2 %>">
                                                        <input type="hidden" name="state" value="<%= addresses[0].state %>">
                                                        <input type="hidden" name="city" value="<%= addresses[0].city %>">
                                                        <input type="hidden" name="zip" value="<%= addresses[0].zip %>">
                                                        <input type="hidden" name="phone" value="<%= addresses[0].phone %>">
                                                    </form>

                                                </div>
                                            </div>

                                        </div>
                                        <hr>
                                        <div class="row">
                                            <div class="col-10">
                                                Delivery instructions (optional)
                                            </div>
                                            <div class="col-2">
                                                <a hred="#">></a>
                                            </div>
                                        </div>

        </div>
        <%}%>
            </div>
            <%- include('parts/footer') %>
